-- DDL generated by Postico 1.5.6
-- Not all database features are supported. Do not use for backup.

-- Table Definition ----------------------------------------------

CREATE TABLE predictions (
    uuid uuid NOT NULL PRIMARY KEY,
    blob jsonb NOT NULL,
    created_at timestamp without time zone NOT NULL DEFAULT now(),
    posted_at timestamp without time zone NOT NULL,
    paused boolean,
    deleted boolean,
    hidden boolean,
    tags text[],
    post_url text
);

-- Indices -------------------------------------------------------

CREATE INDEX predictions_blob_idx ON predictions USING GIN (blob jsonb_ops);
CREATE INDEX predictions_created_at_idx ON predictions(created_at timestamp_ops);
CREATE INDEX predictions_posted_at_idx ON predictions(posted_at timestamp_ops);
CREATE INDEX predictions_tags_idx ON predictions USING GIN (tags array_ops);
CREATE UNIQUE INDEX predictions_post_url_idx ON predictions(post_url text_ops);

CREATE TABLE prediction_state_value_change (
    prediction_uuid uuid NOT NULL,
    state_value text NOT NULL,
    created_at timestamp without time zone DEFAULT now(),
    PRIMARY KEY(prediction_uuid, state_value)
);

CREATE TABLE accounts (
    url text PRIMARY KEY,
    account_type text NOT NULL,
    handle text,
    follower_count bigint,
    thumbnails text[],
    name text,
    description text,
    created_at timestamp without time zone,
    is_verified boolean
);

CREATE TABLE prediction_interactions (
    uuid text PRIMARY KEY,
    post_url text NOT NULL,
    action_type text NOT NULL,
    interaction_post_url text NOT NULL,
    prediction_uuid text NOT NULL,
    created_at timestamp without time zone DEFAULT now()
);

-- Indices -------------------------------------------------------

CREATE UNIQUE INDEX prediction_interactions_post_url_action_type_prediction_uuid_id ON prediction_interactions(post_url text_ops,action_type text_ops,prediction_uuid text_ops);
